<!DOCTYPE html>
<html lang="en">
  {% load static %}

  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="{% static 'css/posts/create.css' %}" />
    <script
      src="https://kit.fontawesome.com/b453b8b1fc.js"
      crossorigin="anonymous"
    ></script>
    <script src="https://cdn.jsdelivr.net/npm/@yaireo/tagify"></script>
    <script src="https://cdn.jsdelivr.net/npm/@yaireo/tagify/dist/tagify.polyfills.min.js"></script>
    <link
      href="https://cdn.jsdelivr.net/npm/@yaireo/tagify/dist/tagify.css"
      rel="stylesheet"
      type="text/css"
    />
    <title>LogCreate</title>
  </head>
  <body>
    <div class="gradient2"></div>
    <div class="container">
      <div class="title">
        <div class="btitle">
          약속은 <br />
          어떠셨나요?
        </div>
      </div>
      <div class="create-log">
        <form
          action="{% url 'posts:create' %}"
          method="post"
          enctype="multipart/form-data"
        >
          {% csrf_token %} {% if postForm.logTitle %}

          {% if meeting %}
          <input type="hidden" name="meetId" value="{{ meeting.id }}" />
          {% else %}
          <div class='create-box'>
            <div class='create-quest'>약속 이름</div>
            <select name="meetId">
              {% for meet in meetingsId %}
              <option value="{{ meet.id }}">{{ meet.meetName }}</option>
              {% endfor %}
            </select>
          </div>
          {% endif %}
          <postForm class='create-box'>
            <label class='create-quest' for="logTitle">제목</label>
            <input
              class='log-input'
              type="text"
              name="logTitle"
              id="logTitle"
              value="{{postForm.logTitle.initial}}"
            />
          </postForm>
          {% endif %}
          <div class="create-box">
            <div class="create-quest">공개 범위</div>
            <select class="log-input" name="openRange">
              {% for key,value in openRanges %}
              <option value="{{key}}">{{value}}</option>
              {% endfor %}
            </select>
          </div>
          <div class="create-box">
            <div class="create-quest">약속 날짜</div>
            <input
              class="log-input"
              type="date"
              name="logDate"
              value="2022-08-23"
              min="2022-01-01"
              max="2022-12-31"
            />
          </div>
          <div class='create-box'>
            <div class='create-quest'>태그</div>
            <input
              name="basic"
            />
          </div>
          <div class="create-box">
            <div class="create-quest">약속 구성원</div>
            <!-- 유저 이름 목록 가져오기 -->
            {% if postForm.logTitle %}
              {% for member in myMeetMembers %}
                <div class='user-name'>{{member}}</div>
              {% endfor %}
            {% endif %}
          </div>
          <div class="create-box">
            <div class="create-quest">어디 다녀오셨나요?</div>
            <div class="places">
              <input
                class="log-input"
                name="place[]"
                type="text"
                placeholder="장소를 추가해주세요"
              />
              <!-- 
            디폴트(meetPlace) 불러오기
            + 버튼에 클릭이벤트로 input element 추가 걸어줄 예정
            장소 여러개 등록
            --></div>
            <div class="place-add">
              <i class="fa-solid fa-circle-plus"></i>
            </div>
          </div>
          <div class="create-box">
            <div class="create-quest">약속은 어땠나요?</div>
            <textarea
              class="log-textarea"
              name="logContent"
              rows="30"
              cols="10"
              placeholder="본문내용"
            ></textarea>
          </div>
          <div class="create-box">
            <div class="create-quest">사진 첨부</div>
            <input type="file" name="logImgs[]"  />
            <input type="file" name="logImgs[]"  />
          </div>
          <div class="create-box">
            <div class="create-quest">동영상 첨부</div>
          </div>
          <input class="btn log-btn" type="submit" value="로그 저장" />
        </form>
      </div>
    </div>
    <script>
      const addBtn = document.querySelector(".place-add");
      const places = document.querySelector(".places");
      addBtn.addEventListener("click", () => {
        let place = document.createElement("input");
        place.setAttribute("class", "log-input");
        place.setAttribute("type", "text");
        place.setAttribute("placeholder", "장소를 추가해주세요");
        place.setAttribute("name", "place[]");
        places.appendChild(place);
      });
    </script>
    <script>
      // The DOM element you wish to replace with Tagify
var input = document.querySelector('input[name=basic]');

// initialize Tagify on the above input node reference
new Tagify(input)
    </script>
  </body>
</html>
